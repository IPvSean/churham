<!DOCTYPE html>
<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>
  <script type="text/javascript">
    var public_spreadsheet_url = 'https://cors-anywhere.herokuapp.com/https://docs.google.com/spreadsheets/d/e/2PACX-1vRtZjJ2AWaJr8JZc0L9Pq7x9k9FAT950h5Pi7Mj_WmjrSU1OzwN26DmCGvCyibBGj8Q4lu9i9nZl7HQ/pub?gid=1804680163&single=true&output=csv';

    function init() {
      Papa.parse(public_spreadsheet_url, {
        download: true,
        header: true,
        complete: showInfo
      })
    }

    window.addEventListener('DOMContentLoaded', init)

    function showInfo(results) {
      var data = results.data
      document.getElementById("sean_id").innerHTML = ""
      // data comes through as a simple array since simpleSheet is turned on
      // alert("Successfully processed " + data.length + " rows!")
      // document.getElementById("runner").innerHTML = "<strong>Runner:</strong> " + [ data[0]['PAX name'], data[1]['PAX name'] ].join(", ");
      for (var pax of data)
      {
        $("#sean_id").append("<tr><td>" + pax['PAX name'] + "</td></td>" + pax['Best time'] + "</td><td>" + pax['Age'] + "</td><td>" + pax['Team Name'] + "</td></tr>");
      }
      console.log(data);
    }

  </script>
</head>
  <body>
    <p><strong>Test by Sean</p>
    <table id="sean_id"></p>
      <tr>
        <th>Name</th>
        <th>Time</th>
        <th>Age</th>
        <th>Team</th>
      </tr>
    </table>



  </body>
</html>
